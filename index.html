<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SHUVOJIT BUY SELL COMMUNITY</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
      body{margin:0;font-family:'Poppins',sans-serif;background:#121212;color:#fff;text-align:center}
      .header-bar{margin:20px auto;display:inline-flex;align-items:center;gap:10px;background:rgba(0,0,0,.5);border-radius:16px;padding:15px 30px;backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.15);position:relative;overflow:hidden}
      .header-bar::before{content:'';position:absolute;top:50%;left:50%;width:250%;height:250%;background:radial-gradient(circle at center,rgba(0,255,255,.15),transparent 50%);animation:continuous-header-glow 8s linear infinite;z-index:1}
      @keyframes continuous-header-glow{0%{transform:translate(-50%,-50%) rotate(0deg)}100%{transform:translate(-50%,-50%) rotate(360deg)}}
      .site-name{font-family:'Orbitron',sans-serif;font-size:1.6em;font-weight:700;display:flex;gap:5px;position:relative;z-index:2}
      .site-name .b{color:#00ff00}.site-name .d{color:red}
      .site-description{font-family:'Poppins',sans-serif;font-size:.9em;color:#ccc;padding:5px 15px}
      .slot{background:rgba(0,0,0,.5);backdrop-filter:blur(12px);padding:20px;margin:30px auto;width:90%;max-width:550px;border-radius:16px;position:relative;overflow:hidden;transition:.4s;box-shadow:0 0 14px rgba(0,0,0,.4);border:1px solid rgba(255,255,255,.1)}
      .slot::before{content:'';position:absolute;top:-120%;left:-120%;width:240%;height:240%;background:radial-gradient(circle at center,rgba(0,255,255,.15),transparent 60%);transform:rotate(25deg);transition:.8s;z-index:1}
      .slot:hover::before{top:0;left:0}
      .slot:hover{transform:translateY(-6px);box-shadow:0 8px 25px rgba(0,255,255,.1)}
      .slot-header,.expand-area,.seller-list,h2,.site-description{position:relative;z-index:2}
      .slot-header{display:flex;align-items:center;justify-content:space-between;gap:15px}
      .slot-header img{height:36px}
      .slot-info{flex:1;text-align:left}
      .slot-price{font-weight:700;color:#ff4d4d}
      .sell-now{background:#fff;padding:10px 20px;border:none;color:#000;font-weight:700;border-radius:8px;cursor:pointer;transition:background-color .3s ease}
      .sell-now:hover{background-color:#e0e0e0}
      .expand-area{display:none;margin-top:20px;text-align:left}
      .expand-area input[type=text]{width:calc(100% - 24px);padding:12px;margin:12px 0;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:#1e1e1e;color:#fff}
      .submit-btn{padding:12px 25px;background:linear-gradient(45deg,#00aaff,#0077cc);color:#fff;font-weight:700;border:none;border-radius:10px;cursor:pointer;transition:background .3s ease}
      .submit-btn:hover{background:linear-gradient(45deg,#0099e6,#0066b3)}
      .waiting-area{display:none;margin-top:15px;color:#bbb;font-weight:600;display:flex;align-items:center;justify-content:center}
      .loader,.loader-mini{border:2px solid #fff;border-top:2px solid transparent;border-radius:50%;animation:spin 1s linear infinite}
      .loader{width:14px;height:14px;margin-right:8px}
      .loader-mini{width:12px;height:12px}
      .pay-method{background:#555;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:700;transition:background .3s ease}
      .pay-method:hover{background:#777}
      .seller-list{max-height:240px;overflow-y:auto;padding-right:8px}
      .seller-row{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.03);border-radius:12px;padding:12px 16px;margin:10px 0}
      .seller-info{display:flex;align-items:center;gap:10px;font-weight:600}
      .seller-info img{width:22px;height:22px}
      .status-box{font-weight:700;display:flex;align-items:center;gap:8px}
      .status-glow{width:10px;height:10px;border-radius:50%;background:#fff;box-shadow:0 0 6px #fff,0 0 12px #0ff;animation:glow 1.6s ease-in-out alternate infinite}
      @keyframes glow{0%{opacity:.3}50%{opacity:1}100%{opacity:.3}}
      @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
      .telegram-link{margin-top:40px;margin-bottom:40px}
      .telegram-link a{display:inline-flex;align-items:center;gap:10px;color:#00aaff;font-weight:700;font-size:18px;text-decoration:none;background:rgba(0,0,0,.3);padding:12px 22px;border-radius:15px;transition:all .3s ease;border:1px solid rgba(255,255,255,.1)}
      .telegram-link a:hover{background:rgba(0,170,255,.15);color:#33bbff}
      .telegram-link img{width:24px;height:24px}
      .seller-list::-webkit-scrollbar{width:6px}
      .seller-list::-webkit-scrollbar-thumb{background:#555;border-radius:4px}
      .error-message{color:red;font-weight:600;}
    .status-glow-reject {
    width:10px;
    height:10px;
    border-radius:50%;
    background:red;
    box-shadow:0 0 6px red,0 0 12px red;
    animation:glow 1.6s ease-in-out alternate infinite;
}
    /* Maintenance Screen */
      #maintenance-screen {
        display:none;
        position:fixed;top:0;left:0;width:100%;height:100%;
        background:#111;color:#fff;
        display:flex;flex-direction:column;justify-content:center;align-items:center;
        text-align:center;z-index:9999;
      }
      .maintenance-logo {
        font-size: 100px;
        animation: float 2s infinite alternate;
      }
      @keyframes float {
        0% { transform: translateY(0px); }
        100% { transform: translateY(-15px); }
      }
      .maintenance-line {
        width: 120px;
        height: 4px;
        background: #00aaff;
        margin: 20px 0;
        animation: lineMove 1s infinite alternate;
      }
      @keyframes lineMove {
        0% { transform: scaleX(0.2); }
        100% { transform: scaleX(1); }
      }
      #maintenance-screen p {
        font-size: 18px;
        font-weight: 600;
        color: #ccc;
        line-height: 1.5;
                  }
  </style>
</head>
<body>
  <!-- Maintenance Mode -->
<div id="maintenance-screen">
  <div class="maintenance-logo">üõ†Ô∏è</div>
  <div class="maintenance-line"></div>
  <p>This website is in maintenance mode.<br>We'll be back soon!</p>
</div>

<script>
// 'ON' = Normal website, 'ON' = Maintenance mode
const websiteMode = 'ON'; // <-- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ON ‡¶¨‡¶æ OFF ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡¶¨‡ßá

document.addEventListener("DOMContentLoaded", () => {
  if (websiteMode === 'OFF') {
    document.getElementById('maintenance-screen').style.display = 'flex';
    document.querySelectorAll('body > *:not(#maintenance-screen)').forEach(el => {
      el.style.display = 'none';
    });
  } else {
    document.getElementById('maintenance-screen').style.display = 'none';
  }
});
</script>

  <div class="header-bar">
    <div class="site-name">
      <span class="b">S</span><span class="d">K</span>
      <span>COMMUNITY</span>
    </div>
  </div>
  <!-- Check Your Report Section -->
<div class="report-section" style="margin:40px auto;text-align:center;">
  <button id="checkReportBtn" style="padding:18px 40px;font-size:20px;font-weight:700;border:none;border-radius:12px;cursor:pointer;background:linear-gradient(45deg,#00aaff,#0077cc);color:#fff;transition:0.3s;">
    Check Your Report
  </button>

  <!-- Hidden buttons -->
  <div id="reportOptions" style="margin-top:20px; display:none; gap:20px; flex-wrap:wrap; justify-content:center;">
    <button id="show00Report" style="padding:14px 28px;font-size:16px;font-weight:600;border:none;border-radius:10px;cursor:pointer;background:#00ff88;color:#000;transition:0.3s;margin:6px;">
      00 Friends ID
    </button>
    <button id="show30Report" style="padding:14px 28px;font-size:16px;font-weight:600;border:none;border-radius:10px;cursor:pointer;background:#ffaa00;color:#000;transition:0.3s;margin:6px;">
      30+ Friends ID
    </button>
    <button id="backHomeBtn" style="padding:14px 28px;font-size:16px;font-weight:600;border:none;border-radius:10px;cursor:pointer;background:#888;color:#fff;transition:0.3s;margin:6px;">
      Back to Homepage
    </button>
  </div>
</div>

<!-- Hidden UID Report Section -->
<div id="uidReportSection" style="display:none; max-width:900px; margin:40px auto; padding:20px; border:1px solid #ddd; border-radius:10px; background:#111; color:#fff;">
  <h2 id="reportTitle" style="text-align:center;">00 Friends Two Factor Report</h2
  <p> <span id="admin-rate"></span></p>
  
  <textarea id="uid-input" placeholder="Paste UID & PASS here... (UID[TAB]PASS)"
    style="width:100%;height:150px;margin:15px 0;padding:10px;border-radius:8px;border:1px solid #555;background:#222;color:#fff;"></textarea>

  <div style="display:flex; justify-content:space-between; gap:10px; margin-top:10px;">
    <button onclick="processUID()" style="padding:12px 25px;font-weight:600;background:#00aaff;color:#fff;border:none;border-radius:8px;cursor:pointer;">
      Check Report
    </button>
    <button id="backHomeFromReport" style="padding:12px 25px;font-weight:600;background:#888;color:#fff;border:none;border-radius:8px;cursor:pointer;">
      Back to Homepage
    </button>
  </div>

  <div id="report" style="margin-top:20px;display:none;">
    <h3>Your Report</h3>
    <p>Total UID: <span id="total-uid">0</span></p>
    <p>‚úÖ OK UID: <span id="ok-uid">0</span></p>
    <p>üö´ Back UID: <span id="back-uid">0</span></p>
    <p>üîÅ Duplicate UID: <span id="duplicate-uid">0</span></p>
    <h3>üíµ Total Amount: <span id="amount">0</span> TK</h3>

    <button onclick="downloadExcel('ok')">üì• Download OK UID (.xlsx)</button>
    <button onclick="downloadExcel('back')">üì• Download BACK UID (.xlsx)</button>
    <button onclick="copyUIDs('ok')">üìã Copy OK UID</button>
    <button onclick="copyUIDs('back')">üìã Copy BACK UID</button>
    <button onclick="copyUIDs('duplicate')">üìã Copy DUPLICATE UID</button>

    <table id="result-table" style="width:100%;margin-top:15px;border-collapse:collapse;">
      <thead>
        <tr style="background:#333;color:#fff;">
          <th>UID</th>
          <th>PASS</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody style="background:#222;"></tbody>
    </table>
  </div>
</div>

<script>
  let currentReportType = '00'; // Default report type

  const checkBtn = document.getElementById('checkReportBtn');
  const reportOptions = document.getElementById('reportOptions');
  const backHomeBtn = document.getElementById('backHomeBtn');
  const backHomeFromReport = document.getElementById('backHomeFromReport');

  // Toggle report options
  checkBtn.addEventListener('click', () => {
    reportOptions.style.display = reportOptions.style.display === 'none' ? 'flex' : 'none';
    document.getElementById('uidReportSection').style.display = 'none';
  });

  // Back to homepage buttons
  backHomeBtn.addEventListener('click', () => {
    reportOptions.style.display = 'none';
    document.getElementById('uidReportSection').style.display = 'none';
  });
  backHomeFromReport.addEventListener('click', () => {
    document.getElementById('uidReportSection').style.display = 'none';
    reportOptions.style.display = 'flex';
  });

  // 00 Friends button ‚Üí show inline report
  document.getElementById('show00Report').addEventListener('click', () => {
    currentReportType = '00';
    document.getElementById('reportTitle').innerText = "29 Date 00 Friends Two Factor Report";
   // document.getElementById('member-rate').innerText = "8.50";
   // document.getElementById('admin-rate').innerText = "8.70";
    document.getElementById('uidReportSection').style.display = 'block';
    reportOptions.style.display = 'none';
  });

  // 30+ Friends button ‚Üí same style report
  document.getElementById('show30Report').addEventListener('click', () => {
    currentReportType = '30';
    document.getElementById('reportTitle').innerText = "28 Date 30+ Friends Two Factor Report";
   // document.getElementById('member-rate').innerText = "12.00";
  //  document.getElementById('admin-rate').innerText = "12.30";
    document.getElementById('uidReportSection').style.display = 'block';
    reportOptions.style.display = 'none';
  });

  // --- UID Processing & Amount Calculation ---
  function processUID() {
    const input = document.getElementById("uid-input").value.trim();
    if (!input) return;

    const lines = input.split("\n");
    const uidPassPairs = lines.map(line => {
      const parts = line.trim().split(/\s+/);
      return { uid: parts[0], pass: parts[1] || "N/A" };
    });

    const seenUIDs = new Set();
    const duplicates = new Set();
    const ok = [];
    const back = [];

    // ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ UID ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü (‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßá ‡¶¶‡ßÅ‡¶ü‡¶ø ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá)
    const okUIDs_00 = ["61580168570948",
"61579769921444",
"61579826528726",
"61579789810140",
"61579849507679",
"61579683915575",
"61579646775502",
"61579784979464",
"61579782369563",
"61579996679200",
"61580130532549",
"61579699004041",
"61579759721198",
"61579656825277",
"61579633336010",
"61579823047920",
"61579961521339",
"61579622986738",
"61580070205785",
"61579718473244",
"61579824637817",
"61579973910982",
"61579965001490",
"61580114394070",
"61579754771843",
"61579753991975",
"61579898405196",
"61580144242705",
"61579614407907",
"61580128343330",
"61579933683349",
"61579885265793",
"61579762091665",
"61580060725710",
"61579790319730",
"61580068345703",
"61579612517309",
"61580144332029",
"61579896004703",
"61579866096144",
"61580050287259",
"61580095705148",
"61579979609451",
"61579744420616",
"61579903713410",
"61579592747398",
"61580145441234",
"61579909653051",
"61580150331082",
"61579927982484",
"61580019897836",
"61579728672254",
"61579747210988",
"61579937942042",
"61580068225334",
"61580018727785",
"61579659344498",
"61579849926942",
"61579817888714",
"61580048397711"]; // Demo 00 list
    const okUIDs_30 = ["61579894383006",
"61580055625243",
"61579731551281",
"61580102063077",
"61579890723563",
"61579981289124",
"61579728607111",
"61580053041248",
"61579874640441",
"61579801173624",
"61579743726375",
"61579927797996",
"61579641280785",
"61580028052487",
"61579526234388",
"61579596433826",
"61580084360610",
"61579499325440",
"61579936528064",
"61579737787896",
"61579974206278",
"61579879501123",
"61579995505283",
"61579955547347",
"61579472535900",
"61579513125740",
"61580086910726",
"61579776456085",
"61579987225684",
"61579926419171",
"61579764576808",
"61579881271191",
"61579878391359",
"61579702449575",
"61579902870230",
"61579879501470",
"61579949727859",
"61579985006047",
"61580095670451",
"61579688530298",
"61579424447342",
"61580098700286",
"61580061052096",
"61579636663077",
"61579586595519",
"61579954708611",
"61580017855260",
"61579727200302",
"61580075303229"]; // Demo 30+ list

    const okUIDs = currentReportType === '30' ? okUIDs_30 : okUIDs_00;

    uidPassPairs.forEach(entry => {
      if (seenUIDs.has(entry.uid)) { duplicates.add(entry.uid); return; }
      seenUIDs.add(entry.uid);
      if (okUIDs.includes(entry.uid)) ok.push(entry);
      else back.push(entry);
    });

    document.getElementById("report").style.display = 'block';
    document.getElementById("total-uid").innerText = uidPassPairs.length;
    document.getElementById("ok-uid").innerText = ok.length;
    document.getElementById("back-uid").innerText = back.length;
    document.getElementById("duplicate-uid").innerText = duplicates.size;

    // Dynamic rate
    let rate;
    if (currentReportType === '30') {
      rate = ok.length < 100 ? 12.00 : 12.30;
    } else {
      rate = ok.length < 200 ? 8.50 : 8.70;
    }

    const amount = ok.length * rate;
    document.getElementById("amount").innerText = amount;

    const tbody = document.querySelector("#result-table tbody");
    tbody.innerHTML = "";
    ok.forEach(entry => {
      tbody.innerHTML += `<tr><td>${entry.uid}</td><td>${entry.pass}</td><td style="color:#0f0;">OK</td></tr>`;
    });
    back.forEach(entry => {
      tbody.innerHTML += `<tr><td>${entry.uid}</td><td>${entry.pass}</td><td style="color:#f00;">BACK</td></tr>`;
    });
  }

  function copyUIDs(type) {
    const rows = document.querySelectorAll("#result-table tbody tr");
    let data = [];
    rows.forEach(row => {
      const uid = row.children[0].innerText;
      const pass = row.children[1].innerText;
      const status = row.children[2].innerText;
      if ((type === 'ok' && status === 'OK') || (type === 'back' && status === 'BACK')) data.push(`${uid}\t${pass}`);
    });
    navigator.clipboard.writeText(data.join("\n"));
    alert(`${type.toUpperCase()} UID copied to clipboard`);
  }

  function downloadExcel(type) {
    const rows = document.querySelectorAll("#result-table tbody tr");
    let lines = [["UID", "Password", "Status"]];
    rows.forEach(row => {
      const uid = row.children[0].innerText;
      const pass = row.children[1].innerText;
      const status = row.children[2].innerText;
      if ((type === 'ok' && status === 'OK') || (type === 'back' && status === 'BACK')) lines.push([uid, pass, status]);
    });
    let csvContent = lines.map(e => e.join("\t")).join("\n");
    let blob = new Blob([csvContent], { type: "application/vnd.ms-excel" });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `${type.toUpperCase()}_UID_Report.xlsx`;
    a.click();
  }
</script>
  <div class="slot">
    <p class="site-description" id="site-description-text">Loading description...</p>
  </div>

  <div id="product-slots-container">
      <div class="slot"><div class="loader-mini" style="margin: auto;"></div> Loading Products...</div>
  </div>

  <div class="slot">
    <h2 style="font-size: 22px; margin-bottom: 15px;">Sellers Overview</h2>
    <div class="seller-list" id="seller-list-container">
       <div class="loader-mini" style="margin: auto;"></div> Loading Sellers...
    </div>
  </div>

  <div class="telegram-link">
    <a href="https://t.me/shuvojit46" target="_blank">
      <img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" alt="Telegram">
      @shuvojit46
    </a>
  </div>

  <script>
    // —Ä–∂–ñ—Ä–∂–∫—Ä–∂–∏—Ä–∂‚ïõ—Ä–∂‚ñë —Ä–∂–∏—Ä–∂–¥—Ä–∑–ë—Ä–∂–∏ —Ä–∂–ü—Ä–∂–º—Ä–∂–í —Ä–∂–™—Ä–∑–í—Ä–∑–¨—Ä–∂‚ïõ—Ä–∂–∏—Ä–∑–ù—Ä–∂–¥ Web App URL —Ä–∂–Ø—Ä–∂‚îê —Ä–∂–ü—Ä–∂–¶—Ä–∂‚ïõ—Ä–∂–∏—Ä–∑–ó —Ä–∂–ø—Ä–∑–õ—Ä–∂–ß —Ä–∂–•—Ä–∂‚ñë—Ä–∂‚ïõ —Ä–∂‚ï£—Ä–∑–Ø—Ä–∑–ó—Ä–∂–´—Ä–∑–ó—Ä–µ–¥
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbxOuTIa_SEZVV1Mrc0IZXQiA3lcW3clWk8Mh8QkT_q9atlj_d1f8UyfTG2g8z-z8SG1/exec'; 

    let allProducts = [];

    document.addEventListener('DOMContentLoaded', loadWebsiteData);

    async function loadWebsiteData() {
        try {
            const response = await fetch(webAppUrl);
            if (!response.ok) {
                throw new Error(`Network response was not ok: ${response.statusText}`);
            }
            if (!response.headers.get("content-type")?.includes("application/json")) {
                 throw new Error("Received non-JSON response. Check Apps Script permissions and ensure it's deployed for 'Anyone'.");
            }
            const data = await response.json();
            if (data.error) {
                throw new Error(`Apps Script Error: ${data.error}`);
            }
            allProducts = data.products;
            displaySettings(data.settings);
            displayProducts(data.products);
            displaySellers(data.sellers, data.products);
        } catch (error) {
            console.error('Data Loading Error:', error);
            const errorMessage = `<div class="slot error-message">${error.message}</div>`;
            document.getElementById('site-description-text').textContent = "Failed to load description.";
            document.getElementById('product-slots-container').innerHTML = errorMessage;
            document.getElementById('seller-list-container').innerHTML = `<div class="error-message">Failed to load sellers.</div>`;
        }
    }
    setInterval(loadWebsiteData, 60000);
    function displaySettings(settings) {
        const descElement = document.getElementById('site-description-text');
        if (settings && settings.SiteDescription) { descElement.textContent = settings.SiteDescription; } 
        else { descElement.textContent = "Welcome to our marketplace!"; }
    }

    function displayProducts(products) {
        const container = document.getElementById('product-slots-container');
        if (!products || products.length === 0) { container.innerHTML = '<div class="slot">No products found in your Google Sheet.</div>'; return; }
        container.innerHTML = products.map(p => {
            const paymentButtons = p.methods.map(method => `<button class="pay-method" onclick="showPaymentInput(this, '${method.toLowerCase()}')">${method}</button>`).join('');
            return `<div class="slot" data-product-name="${p.name}"><div class="slot-header"><img src="${p.logo}" alt="${p.name} logo"><div class="slot-info"><div>${p.name}</div><div class="slot-price">${p.price}</div></div><button class="sell-now" onclick="toggleExpand(this)">Sell Now</button></div><div class="expand-area"><input type="text" class="seller-name-input" placeholder="Enter your name"><input type="text" class="sheet-link-input" placeholder="Paste your Google Sheet link here"><div style="margin:10px 0 6px;font-weight:600">Add payment method</div><div style="display:flex;gap:10px;margin-bottom:10px">${paymentButtons}</div><input type="text" class="payment-input" style="display:none" placeholder=""><button class="submit-btn" onclick="submitSale(this)">Submit</button><div class="waiting-area"><span class="loader"></span>Submitting...</div><div class="submit-message" style="margin-top: 15px; font-weight: 600;"></div></div></div>`;
        }).join("");
    }

    function displaySellers(sellers, products) {
    const container = document.getElementById('seller-list-container');
    if (!sellers || sellers.length === 0) {
        container.innerHTML = '<div style="padding: 10px;">No sellers yet.</div>';
        return;
    }

    // Waiting priority
    sellers.sort((a, b) => (a.status.toLowerCase() === 'waiting' && b.status.toLowerCase() !== 'waiting' ? -1 : 1));

    container.innerHTML = sellers.map(seller => {
        const product = products.find(p => p.name === seller.product);
        const logo = product ? product.logo : 'https://i.imgur.com/sF4J6Uj.png';

        let statusHtml = '';
        const statusLower = seller.status.toLowerCase();

        if (statusLower === 'received') {
            statusHtml = `<div class="status-box">Received <div class="status-glow"></div></div>`;
        } else if (statusLower === 'rejected') {
            statusHtml = `<div class="status-box">Rejected <div class="status-glow-reject"></div></div>`;
        } else {
            statusHtml = `<div class="status-box"><span class="loader-mini"></span> Waiting...</div>`;
        }

        return `<div class="seller-row">
                    <div class="seller-info">
                        <img src="${logo}" alt="${seller.product} logo">
                        <span>${seller.name.toUpperCase()}</span>
                    </div>
                    ${statusHtml}
                </div>`;
    }).join('');
}

    function toggleExpand(btn) { const ex = btn.closest('.slot').querySelector('.expand-area'); ex.style.display = ex.style.display === 'block' ? 'none' : 'block'; }
    
    function showPaymentInput(btn, method) {
        const expandArea = btn.closest('.expand-area');
        const input = expandArea.querySelector('.payment-input');
        input.style.display = 'block';
        input.placeholder = `Enter your ${method} account number`;
        expandArea.dataset.paymentMethod = method;
    }

    function submitSale(btn) {
        const slot = btn.closest('.slot');
        const expandArea = btn.closest('.expand-area');
        const sellerName = expandArea.querySelector('.seller-name-input').value.trim();
        const sheetLink = expandArea.querySelector('.sheet-link-input').value.trim();
        const paymentNumber = expandArea.querySelector('.payment-input').value.trim();
        const paymentMethod = expandArea.dataset.paymentMethod;
        const productName = slot.dataset.productName;
        const messageDiv = expandArea.querySelector('.submit-message');
        if (!sellerName || !sheetLink || !paymentNumber || !paymentMethod) { messageDiv.textContent = 'Please fill all fields.'; messageDiv.style.color = 'red'; return; }
        const waitingDiv = expandArea.querySelector('.waiting-area');
        waitingDiv.style.display = 'flex';
        btn.style.display = 'none';
        messageDiv.textContent = '';
        const submissionData = { sellerName, productName, paymentMethod, paymentNumber, sheetLink };
        fetch(webAppUrl, { method: 'POST', body: JSON.stringify(submissionData), mode: 'no-cors' })
            .then(() => {
                messageDiv.textContent = 'Submission successful! Please refresh the page to see your name in the list.';
                messageDiv.style.color = '#00ff00';
                waitingDiv.style.display = 'none';
            })
            .catch(error => {
                console.error('Submission Error:', error);
                messageDiv.textContent = 'Submission failed. Please try again.';
                messageDiv.style.color = 'red';
                waitingDiv.style.display = 'none';
                btn.style.display = 'block';
            });
    }
  </script>
</body>
</html>
